(function(){this.App=angular.module("frontendAdmin",["mnoEnterprise.configuration","ngAnimate","ngAria","ngCookies","ngMessages","restangular","ui.router","ui.bootstrap","toastr","ncy-angular-breadcrumb","platanus.inflector","smart-table","angularMoment","duScroll","ngPageTitle"])}).call(this),function(){this.App.config(["$logProvider","toastrConfig",function(t,e){return t.debugEnabled(!0),e.allowHtml=!0,e.timeOut=3e3,e.positionClass="toast-top-right",e.preventDuplicates=!0,e.progressBar=!0}]).config(["$httpProvider",function(t){return t.interceptors.push(["$q","$window","$injector","$log",function(t,e,n,i){return{responseError:function(a){var s;return 401===a.status&&(s=n.get("toastr"),e.location.href="/",s.error("You are no longer connected or not an administrator, you will be redirected to the dashboard."),i.error("User is not connected!")),t.reject(a)}}}])}])}.call(this),function(){this.App.constant("USER_ROLES",["Member","Power User","Admin","Super Admin"]).constant("ADMIN_ROLES",["admin","staff"]).constant("STAFF_PAGE_AUTH",["admin"]).constant("OBS_KEYS",{userChanged:"userListChanged",staffChanged:"staffListChanged",staffAdded:"staffAdded"})}.call(this),function(){this.App.config(["$stateProvider","$urlRouterProvider",function(t,e){"ngInject";return t.state("dashboard",{"abstract":!0,templateUrl:"app/views/dashboard.layout.html",controller:"DashboardController",controllerAs:"main"}).state("dashboard.home",{data:{pageTitle:"Home"},url:"/home",templateUrl:"app/views/home/home.html",controller:"HomeController",controllerAs:"vm",ncyBreadcrumb:{label:"Home"}}).state("dashboard.home.user",{data:{pageTitle:"User"},url:"^/user/:userId",views:{"@dashboard":{templateUrl:"app/views/user/user.html",controller:"UserController",controllerAs:"vm"}},ncyBreadcrumb:{label:"User"}}).state("dashboard.home.organization",{data:{pageTitle:"Organization"},url:"^/organization/:orgId",views:{"@dashboard":{templateUrl:"app/views/organization/organization.html",controller:"OrganizationController",controllerAs:"vm"}},ncyBreadcrumb:{label:"Organisation"}}).state("dashboard.finance",{data:{pageTitle:"Finance"},url:"/finance",templateUrl:"app/views/finance/finance.html",controller:"FinanceController",controllerAs:"vm",ncyBreadcrumb:{label:"Finance"}}).state("dashboard.staff",{data:{pageTitle:"Staff"},url:"/staff",templateUrl:"app/views/staff/staff.html",controller:"StaffController",controllerAs:"vm",ncyBreadcrumb:{label:"Staff"},resolve:{skip:["MnoeCurrentUser",function(t){return t.skipIfNotAdmin()}]}}).state("dashboard.customers",{data:{pageTitle:"Customers"},url:"/customers",templateUrl:"app/views/customers/customers.html",controller:"CustomersController",controllerAs:"vm",ncyBreadcrumb:{label:"Customers"}}).state("dashboard.customers.create-step-1",{url:"^/customers/create-customer",views:{"@dashboard":{templateUrl:"app/views/customers/create-step-1/create-step-1.html",controller:"CreateStep1Controller",controllerAs:"vm"}},ncyBreadcrumb:{label:"Create a new customer"}}).state("dashboard.customers.create-step-2",{url:"^/customers/:orgId/connect-apps",views:{"@dashboard":{templateUrl:"app/views/customers/create-step-2/create-step-2.html",controller:"CreateStep2Controller",controllerAs:"vm"}},ncyBreadcrumb:{label:"Connect cloud apps"}}),e.otherwise("/home")}])}.call(this),function(){this.App.run(["$rootScope","APP_NAME",function(t,e){return t.app_name=e}]).run(["$rootScope",function(t){return t.$on("$viewContentLoaded",function(){return window.scrollTo(0,0)})}])}.call(this),function(){this.App.controller("DashboardController",["$scope","$cookies","$sce","MnoeMarketplace","MnoErrorsHandler","MnoeCurrentUser","STAFF_PAGE_AUTH",function(t,e,n,i,a,s,r){"ngInject";var o,l;o=this,o.errorHandler=a,o.staffPageAuthorized=r,o.trustSrc=function(t){return n.trustAsResourceUrl(t)},l=992,o.getWidth=function(){return window.innerWidth},t.$watch(o.getWidth,function(t){return t>=l?angular.isDefined(e.get("admin_platform_toggle"))?o.toggle=e.get("admin_platform_toggle")?!0:!1:o.toggle=!0:o.toggle=!1}),o.toggleSidebar=function(){return o.toggle=!o.toggle,e.put("admin_platform_toggle",o.toggle)},window.onresize=function(){return t.$apply()},s.getAdminRole().then(o.user=s.user)}])}.call(this),function(){this.App.service("MnoAppsInstances",function(){var t;return t=this,this.isConnected=function(e){return"cube"===e.stack||"cloud"===e.stack||t.isOauthConnected(e)},this.isOauthConnected=function(t){return"connector"===t.stack&&t.oauth_keys_valid},this.oAuthConnectPath=function(t){var e;return e=window.encodeURIComponent(""+location.pathname+location.hash),"/mnoe/webhook/oauth/"+t.uid+"/authorize?redirect_path="+e},this.canBeDataSynced=function(t){return"connector"===t.stack&&t.oauth_keys_valid},this.dataSyncPath=function(t){return"/mnoe/webhook/oauth/"+t.uid+"/sync"},this.canBeDisconnected=function(t){return"connector"===t.stack&&t.oauth_keys_valid},this.disconnectPath=function(t){return"/mnoe/webhook/oauth/"+t.uid+"/disconnect"},this})}.call(this),function(){this.App.service("MnoErrorsHandler",["$log",function(t){var e,n;return e=this,n=null,this.processServerError=function(e,i){var a;return t.error("An error occurred:",e),_.startsWith(e.data,"<!DOCTYPE html>")?void 0:400<=(a=e.status)&&499>=a?(n=e,_.each(n.data,function(e,n){return _.each(e,function(){return null!=i[n]?i[n].$setValidity("server",!1):t.error("MnoErrorsHandler: cannot find field:"+n)})})):void 0},this.errorMessage=function(t){var e;return e=[],null!=n&&_.each(n.data[t],function(t){return e.push(t)}),e.join(", ")},this.resetErrors=function(t){return null!=n?(_.each(n.data,function(e,n){return _.each(e,function(){return null!=t[n]?t[n].$setValidity("server",null):void 0})}),n=null):void 0},this.onlyServerError=function(t){return _.every(t.$error,function(t,e){return"server"===e})},this}])}.call(this),function(){this.App.service("MnoConfirm",["$uibModal",function(t){var e,n,i;return e=this,i={closeButtonText:"Close",actionButtonText:"OK",headerText:"Proceed?",bodyText:"Perform this action?"},n={backdrop:!0,keyboard:!0,modalFade:!0,templateUrl:"app/components/mno-confirm/mno-confirm.html"},this.showModal=function(t,n){return null==n&&(n=null),null==n&&(n={}),n.backdrop="static",e.show(t,n)},this.show=function(e,a){var s,r;return null==a&&(a=null),s={},r={},angular.extend(r,i,e),angular.extend(s,n,a),s.controller||(s.controller=["$scope","$uibModalInstance",function(t,e){"ngInject";return t.modalOptions=r,t.modalOptions.ok=function(t){return e.close(t)},t.modalOptions.close=function(t){return e.dismiss("cancel")}}]),t.open(s).result},this}])}.call(this),function(){this.App.constant("ITEMS_PER_PAGE",[10,20,50,100]),this.App.directive("mnoPagination",["ITEMS_PER_PAGE",function(t){return{restrict:"AE",scope:{totalItems:"=",onChangeCb:"&",nbItemsValues:"=?",nbItems:"=",page:"=",isLoading:"=?"},templateUrl:"app/components/mno-pagination/mno-pagination.html",link:function(e){return e.pagination={maxPages:7},e.nbItemsValues||(e.nbItemsValues=t),e.onPageChange=function(){return e.onChangeCb({nbItems:e.nbItems,page:e.page})}}}}])}.call(this),function(){this.App.factory("MnoeApiSvc",["$log","Restangular","inflector",function(t,e,n){return e.withConfig(function(t){return t.setBaseUrl("/mnoe/jpi/v1"),t.setDefaultHeaders({Accept:"application/json"}),t.setFullResponse(!0),t.addResponseInterceptor(function(t,e,i,a,s,r){var o;return _.startsWith(i,"/")?t:(o=null,"getList"===e?o=t[i]:"get"===e||"put"===e||"post"===e?(i=n.singularize(i),o=t[i]):o=t,o)})})}])}.call(this),function(){this.App.service("MnoeMarketplace",["$log","MnoeApiSvc",function(t,e){var n,i,a;return n=this,i=e.oneUrl("/marketplace"),a=null,this.getApps=function(){return null!=a?a:a=i.get()},this}])}.call(this),function(){this.App.directive("mnoeOrganizationsList",["$filter","$log","MnoeOrganizations",function(t,e,n){return{restrict:"E",scope:{list:"="},templateUrl:"app/components/mnoe-organizations-list/mnoe-organizations-list.html",link:function(i,a,s){var r,o,l,c,d;return i.state=s.view,i.organizations={search:"",nbItems:10,page:1,pageChangedCb:function(t,e){var n;return i.organizations.nbItems=t,i.organizations.page=e,n=(e-1)*t,o(t,n)}},o=function(t,e,a){return null==a&&(a="name"),i.organizations.loading=!0,n.list(t,e,a).then(function(t){return i.organizations.totalItems=t.headers("x-total-count"),i.organizations.list=t.data}).then(function(){return i.organizations.loading=!1})},i.switchState=function(){return i.state=s.view="all"===s.view?"last":"all",r()},r=function(){return"all"===s.view?(l(),o(i.organizations.nbItems,0)):"last"===s.view?(c(),o(i.organizations.nbItems,0,"created_at.desc")):e.error('Value of attribute view can only be "all" or "last"')},l=function(){return i.organizations.widgetTitle="All organisations",i.organizations.switchLinkTitle="(last 10)"},c=function(){return i.organizations.widgetTitle="Last 10 organisations",i.organizations.switchLinkTitle="(view all)"},i.searchChange=function(){return i.organizations.search.length>=3?(i.searchMode=!0,d(i.organizations.search)):i.searchMode?(i.searchMode=!1,r()):void 0},d=function(e){var a;return i.organizations.loading=!0,i.organizations.widgetTitle="Search result",delete i.organizations.switchLinkTitle,e=i.organizations.search.toLowerCase(),a={"name.like":"%"+e+"%"},n.search(a).then(function(e){return i.organizations.totalItems=e.headers("x-total-count"),i.organizations.list=t("orderBy")(e.data,"name")})["finally"](function(){return i.organizations.loading=!1})},r()}}}])}.call(this),function(){this.App.directive("mnoeOrganizationsLocalList",["$filter","$log",function(t,e){return{restrict:"E",scope:{list:"="},templateUrl:"app/components/mnoe-organizations-local-list/mnoe-organizations-local-list.html",link:function(n,i,a){var s,r,o,l;return n.organizations={displayList:[],widgetTitle:"Loading organizations...",search:""},r=function(){return n.organizations.widgetTitle="All organizations ("+n.list.length+")",n.organizations.switchLinkTitle="(last 10)",n.organizations.displayList=t("orderBy")(n.list,"email")},o=function(){return n.organizations.widgetTitle="Last 10 organizations",n.organizations.switchLinkTitle="(view all)",n.organizations.displayList=t("orderBy")(n.list,"-created_at"),n.organizations.displayList=t("limitTo")(n.organizations.displayList,10)},l=function(){var e;return n.organizations.widgetTitle="Search result",delete n.organizations.switchLinkTitle,e=n.organizations.search.toLowerCase(),n.organizations.displayList=_.filter(n.list,function(t){var n,i,a;return t.email&&(n=_.contains(t.email.toLowerCase(),e)),t.name&&(i=_.contains(t.name.toLowerCase(),e)),t.surname&&(a=_.contains(t.surname.toLowerCase(),e)),n||i||a}),n.organizations.displayList=t("orderBy")(n.organizations.displayList,"email")},s=function(){return"all"===a.view?r():"last"===a.view?o():e.error('Value of attribute view can only be "all" or "last"')},n.switchState=function(){return"all"===a.view?a.view="last":a.view="all",s()},n.searchChange=function(){return""===n.organizations.search?s():l()},n.$watch("list",function(t){return t?s():void 0},!0)}}}])}.call(this),function(){this.App.component("mnoeStaffsList",{templateUrl:"app/components/mnoe-staffs-list/mnoe-staffs-list.html",bindings:{view:"@"},controller:["$filter","$log","MnoeUsers","MnoConfirm","MnoeObservables","ADMIN_ROLES","OBS_KEYS","toastr",function(t,e,n,i,a,s,r,o){var l,c,d,u;u=this,u.listOfStaff=[],u.callServer=function(t){var e,n;return n=d(t.sort),e=c(t.search),l(u.staff.nbItems,u.staff.offset,n,e)},d=function(t){var e;return null==t&&(t={}),e="surname",t.predicate&&(e=t.predicate,e+=t.reverse?".desc":".asc"),u.staff.sort=e,e},c=function(t){var e,n,i,a;if(null==t&&(t={}),i={},t.predicateObject){n=t.predicateObject;for(e in n)a=n[e],"admin_role"===e?i["where[admin_role.in][]"]=[a]:i["where["+e+".like]"]=a+"%"}return u.staff.search=i,i},u.state=u.view,u.staff={editmode:[],search:{},sort:"surname",nbItems:10,page:1,roles:s,pageChangedCb:function(t,e){var n;return u.staff.nbItems=t,u.staff.page=e,n=(e-1)*t,l(t,n)},update:function(t){return n.updateStaff(t).then(function(e){return d(),c(),delete u.staff.editmode[t.id]},function(t){return e.error("Error while saving user",t),o.error("An error occurred while saving the user.")})},remove:function(t){var e;return e={closeButtonText:"Cancel",actionButtonText:"Delete Team Member",headerText:"Delete "+t.name+" "+t.surname+"?",bodyText:"Are you sure you want to delete this team member?"},i.showModal(e).then(function(){return console.log("Remove staff role:"+t),n.removeStaff(t.id).then(function(){return o.success(t.name+" "+t.surname+" has been successfully removed.")})})}},l=function(t,e,i,a){return null==i&&(i=u.staff.sort),null==a&&(a=u.staff.search),u.staff.loading=!0,n.staffs(t,e,i,a).then(function(t){return u.staff.totalItems=t.headers("x-total-count"),u.listOfStaff=t.data})["finally"](function(){return u.staff.loading=!1})},l(u.staff.nbItems,0).then(function(){return a.registerCb(r.staffAdded,function(){return l(u.staff.nbItems,u.staff.offset)}),a.registerCb(r.staffChanged,function(){return l(u.staff.nbItems,u.staff.offset)})})}]})}.call(this),function(){this.App.directive("mnoeUsersList",["$filter","$log","MnoeUsers",function(t,e,n){return{restrict:"E",scope:{},templateUrl:"app/components/mnoe-users-list/mno-users-list.html",link:function(i,a,s){var r,o,l,c,d;return i.state=s.view,i.users={search:"",nbItems:10,page:1,pageChangedCb:function(t,e){var n;return i.users.nbItems=t,i.users.page=e,n=(e-1)*t,o(t,n)}},o=function(t,e,a){return null==a&&(a="surname"),i.users.loading=!0,n.list(t,e,a).then(function(t){return i.users.totalItems=t.headers("x-total-count"),i.users.list=t.data})["finally"](function(){return i.users.loading=!1})},i.switchState=function(){return i.state=s.view="all"===s.view?"last":"all",r()},r=function(){return"all"===s.view?(l(),o(i.users.nbItems,0)):"last"===s.view?(c(),o(10,0,"created_at.desc")):e.error('Value of attribute view can only be "all" or "last"')},l=function(){return i.users.widgetTitle="All users",i.users.switchLinkTitle="(last 10)"},c=function(){return i.users.widgetTitle="Last 10 users",i.users.switchLinkTitle="(view all)"},i.searchChange=function(){return i.users.search.length>=3?(i.searchMode=!0,d(i.users.search)):i.searchMode?(i.searchMode=!1,r()):void 0},d=function(e){var a;return i.users.loading=!0,i.users.widgetTitle="Search result",delete i.users.switchLinkTitle,e=i.users.search.toLowerCase(),a={"surname.like":e+"%","name.like":e+"%","email.like":"%"+e+"%"},n.search(a).then(function(e){return i.users.totalItems=e.headers("x-total-count"),i.users.list=t("orderBy")(e.data,"email")})["finally"](function(){return i.users.loading=!1})},r()}}}])}.call(this),function(){this.App.directive("mnoeUsersLocalList",["$window","$filter","$log","toastr","MnoeUsers","MnoErrorsHandler",function(t,e,n,i,a,s){return{restrict:"E",scope:{list:"=",organization:"="},templateUrl:"app/components/mnoe-users-local-list/mnoe-users-local-list.html",link:function(r,o,l){var c,d,u,m;return r.users={displayList:[],widgetTitle:"Loading users...",search:""},d=function(){return r.users.widgetTitle="All users ("+r.list.length+")",r.users.switchLinkTitle="(last 10)",r.users.displayList=e("orderBy")(r.list,"email")},u=function(){return r.users.widgetTitle="Last 10 users",r.users.switchLinkTitle="(view all)",r.users.displayList=e("orderBy")(r.list,"-created_at"),r.users.displayList=e("limitTo")(r.users.displayList,10)},m=function(){var t;return r.users.widgetTitle="Search result",delete r.users.switchLinkTitle,t=r.users.search.toLowerCase(),r.users.displayList=_.filter(r.list,function(e){var n,i,a;return e.email&&(n=_.contains(e.email.toLowerCase(),t)),e.name&&(i=_.contains(e.name.toLowerCase(),t)),e.surname&&(a=_.contains(e.surname.toLowerCase(),t)),n||i||a}),r.users.displayList=e("orderBy")(r.users.displayList,"email")},c=function(){return"all"===l.view?d():"last"===l.view?u():n.error('Value of attribute view can only be "all" or "last"')},r.switchState=function(){return"all"===l.view?l.view="last":l.view="all",c()},r.searchChange=function(){return""===r.users.search?c():m()},r.sendInvitation=function(t){return t.isSendingInvite=!0,a.inviteUser(r.organization,t).then(function(e){return i.success(t.name+" "+t.surname+"'s invitation has been sent."),t.status=e.data.user.status},function(e){return i.error("An error occurred: "+t.name+" "+t.surname+"'s invitation has not been sent."),s.processServerError(e)})["finally"](function(){return t.isSendingInvite=!1})},r.impersonateUser=function(e){var n,i;return e?(n=window.encodeURIComponent(""+location.pathname+location.hash),i="/mnoe/impersonate/user/"+e.id+"?redirect_path="+n,t.location.href=i):void 0},r.$watch("list",function(t){return t?c():void 0},!0)}}}])}.call(this),function(){this.App.directive("rdKpiBodyCurrency",function(){return{requires:"^rdKpi",scope:{currency:"@",amount:"@"},templateUrl:"app/components/rdash-angular/kpi-body-currency.html",restrict:"E"}})}.call(this),function(){this.App.directive("rdKpiBodyNumber",function(){return{requires:"^rdKpi",scope:{number:"@"},templateUrl:"app/components/rdash-angular/kpi-body-number.html",restrict:"E"}})}.call(this),function(){this.App.directive("rdKpi",function(){return{transclude:!0,scope:{icon:"@",description:"@",link:"@",linkText:"@",loading:"=?"},templateUrl:"app/components/rdash-angular/kpi.html",restrict:"EA"}})}.call(this),function(){this.App.directive("rdLoading",function(){return{restrict:"AE",template:'<div class="loading"><div class="double-bounce1"></div><div class="double-bounce2"></div></div>'}})}.call(this),function(){this.App.directive("rdWidgetBody",function(){return{requires:"^rdWidget",scope:{loading:"=?",classes:"@?"},transclude:!0,template:'<div class="widget-body" ng-class="classes"><rd-loading ng-show="loading"></rd-loading><div ng-hide="loading" class="widget-content" ng-transclude></div></div>',restrict:"E"}})}.call(this),function(){this.App.directive("rdWidgetFooter",function(){return{requires:"^rdWidget",transclude:!0,template:'<div class="widget-footer" ng-transclude></div>',restrict:"E"}})}.call(this),function(){this.App.directive("rdWidgetHeader",function(){return{requires:"^rdWidget",scope:{title:"@",icon:"@"},transclude:!0,template:'<div class="widget-header"><div class="row"><div class="pull-left"><i class="fa" ng-class="icon"></i> {{title}} </div><div ng-transclude></div></div></div>',restrict:"E"}})}.call(this),function(){this.App.directive("rdWidget",function(){return{scope:{loading:"=?",classes:"@?"},transclude:!0,template:'<div class="widget"><rd-loading ng-show="loading"></rd-loading><div ng-hide="loading" ng-transclude></div></div>',restrict:"EA"}})}.call(this),function(){this.App.service("MnoeObservables",function(){var t,e;t=this,e={},this.registerCb=function(t,n){return _.isEmpty(e[t])&&(e[t]=[]),e[t].push(n)},this.notifyObservers=function(t,n){return _.forEach(e[t],function(t){return t(n)})},this.unsubscribe=function(t,n){return _.remove(e[t],n)(function(){return _.isEmpty(e[t])?delete e[t]:void 0})}})}.call(this),function(){this.App.controller("CustomersController",["$uibModal","MnoeUsers","MnoeOrganizations","MnoeObservables","OBS_KEYS",function(t,e,n,i,a){"ngInject";var s;s=this,s.users={},s.organizations={},s.invoices={},s.inviteUserModal=function(){return t.open({templateUrl:"app/views/customers/invite-user-modal/invite-user.html",controller:"InviteUserController",controllerAs:"vm"})},i.registerCb(a.userChanged,function(t){return t.then(function(t){return s.users.totalCount=t.headers("x-total-count")})}),n.registerListChangeCb(function(t){return t.then(function(t){return s.organizations.totalCount=t.headers("x-total-count")})})}])}.call(this),function(){this.App.controller("FinanceController",["$filter","MnoeInvoices","MnoeTenantInvoices","MnoeOrganizations",function(t,e,n,i){"ngInject";var a;a=this,a.invoices={},a.organizations={},e.currentBillingAmount().then(function(t){return a.invoices.currentBillingAmount=t.data}),e.lastInvoicingAmount().then(function(t){return a.invoices.lastInvoicingAmount=t.data}),e.lastPortfolioAmount().then(function(t){return a.invoices.lastPortfolioAmount=t.data}),e.lastCommissionAmount().then(function(t){return a.invoices.lastCommissionAmount=t.data}),n.list().then(function(e){return a.invoices.tenantInvoices=e.data,a.invoices.tenantInvoices=t("orderBy")(a.invoices.tenantInvoices,"-started_at")}),i.inArrears().then(function(e){return a.organizations.inArrears=e.data,_.forEach(a.organizations.inArrears,function(t){return t.category=_.capitalize(t.category.replace("_"," "))}),a.organizations.inArrears=t("orderBy")(a.organizations.inArrears,"-started_at")})}])}.call(this),function(){this.App.controller("HomeController",["moment","MnoeUsers","MnoeOrganizations","MnoeInvoices",function(t,e,n,i){"ngInject";var a;a=this,a.users={},a.organizations={},a.invoices={},e.count().then(function(t){return a.users.kpi=t.data}),n.count().then(function(t){return a.organizations.kpi=t.data}),i.lastInvoicingAmount().then(function(t){return a.invoices.lastInvoicingAmount=t.data}),i.outstandingAmount().then(function(t){return a.invoices.outstandingAmount=t.data})}])}.call(this),function(){this.App.controller("OrganizationController",["$filter","$stateParams","$uibModal","toastr","MnoeOrganizations","MnoeUsers","MnoAppsInstances",function(t,e,n,i,a,s,r){"ngInject";var o;return o=this,o.orgId=e.orgId,o.users={},o.mnoAppInstances=r,o.users.createUserModal=function(){var t;return t=n.open({templateUrl:"app/views/organization/create-user-modal/create-user.html",controller:"CreateUserController",controllerAs:"vm",resolve:{organization:o.organization}}),t.result.then(function(t){return o.organization.members.push(t)})},a.get(e.orgId).then(function(e){return o.organization=e.data,o.organization.invoices=t("orderBy")(o.organization.invoices,"-started_at")}),o}])}.call(this),function(){this.App.controller("StaffController",["$filter","$stateParams","$uibModal","toastr","MnoeUsers","MnoAppsInstances",function(t,e,n,i,a,s){"ngInject";var r;return r=this,r.staff={createModal:function(){var t;return t=n.open({templateUrl:"app/views/staff/create-staff-modal/create-staff.html",controller:"CreateStaffController",controllerAs:"vm"})}},r.displayed=[],r.callServer=function(t){return console.log(t),r.isLoading=!1},r}])}.call(this),function(){this.App.controller("UserController",["$stateParams","$window","MnoeUsers",function(t,e,n){"ngInject";var i;i=this,n.get(t.userId).then(function(t){return i.user=t.data}),i.impersonateUser=function(){var t,n;return i.user?(t=window.encodeURIComponent(""+location.pathname+location.hash),n="/mnoe/impersonate/user/"+i.user.id+"?redirect_path="+t,e.location.href=n):void 0}}])}.call(this),function(){this.App.factory("MnoeAdminApiSvc",["MnoeApiSvc",function(t){return t.all("admin")}])}.call(this),function(){this.App.service("MnoeCurrentUser",["MnoeApiSvc","$window","$state","$q",function(t,e,n,i){var a,s;return a=this,s=null,this.user={},this.getAdminRole=function(){return null!=s?s:s=t.one("current_user").get().then(function(t){var e;return e={admin_role:t.data.admin_role},angular.copy(e,a.user),t})},this.skipIfNotAdmin=function(){return null!=a.user.admin_role&&"admin"===a.user.admin_role?i.resolve():($timeout(function(){return n.go("dashboard.home")}),i.reject())},this}])}.call(this),function(){this.App.service("MnoeInvoices",["MnoeAdminApiSvc",function(t){var e;return e=this,this.currentBillingAmount=function(){return t.all("invoices").customGET("current_billing_amount")},this.lastInvoicingAmount=function(){return t.all("invoices").customGET("last_invoicing_amount")},this.outstandingAmount=function(){return t.all("invoices").customGET("outstanding_amount")},this.lastPortfolioAmount=function(){return t.all("invoices").customGET("last_portfolio_amount")},this.lastCommissionAmount=function(){return t.all("invoices").customGET("last_commission_amount")},this}])}.call(this),function(){this.App.service("MnoeOrganizations",["MnoeAdminApiSvc",function(t){var e,n,i;return e=this,this.list=function(e,i,a){var s;return s=t.all("organizations").getList({order_by:a,limit:e,offset:i}).then(function(t){return n(s),t})},i=[],this.registerListChangeCb=function(t){return i.push(t)},n=function(t){return _.forEach(i,function(e){return e(t)})},this.search=function(e){return t.all("organizations").getList({terms:e})},this.inArrears=function(){return t.all("organizations").all("in_arrears").getList()},this.get=function(e){return t.one("organizations",e).get()},this.count=function(){return t.all("organizations").customGET("count")},this.create=function(e){return t.all("/organizations").post(e)},this}])}.call(this),function(){this.App.service("MnoeTenantInvoices",["MnoeAdminApiSvc",function(t){var e;return e=this,this.list=function(){return t.all("tenant_invoices").getList()},this}])}.call(this),function(){this.App.service("MnoeUsers",["$q","$log","MnoeAdminApiSvc","MnoeObservables","OBS_KEYS",function(t,e,n,i,a){var s,r;return r=this,this.list=function(t,e,s){var r;return r=n.all("users").getList({order_by:s,limit:t,offset:e}).then(function(t){return i.notifyObservers(a.userChanged,r),t})},this.staffs=function(t,e,n,i){return null==i&&(i={}),i["where[admin_role.in][]"]||(i["where[admin_role.not]"]=""),s(t,e,n,i)},this.search=function(t){return n.all("users").getList({terms:t})},this.get=function(t){return n.one("users",t).get()},this.count=function(){return n.all("users").customGET("count")},this.addUser=function(t,e){return n.one("organizations",t.id).all("/users").post({user:e})},this.addStaff=function(t){var e;return e=n.all("users").post({user:t}).then(function(t){return i.notifyObservers(a.staffAdded,e),t})},this.updateStaff=function(t){var e;return e=n.one("users",t.id).patch({user:t}).then(function(t){return i.notifyObservers(a.staffChanged,e),t})},this.removeStaff=function(t){var s;return s=n.one("users",t).patch({admin_role:""}).then(function(t){return i.notifyObservers(a.staffChanged,s)},function(t){return e.error("Error while deleting user",t),toastr.error("An error occured while deleting the user.")})},this.inviteUser=function(t,e){return n.one("organizations",t.id).one("users",e.id).doPOST({},"/invites")},this.sendSignupEmail=function(t){return n.all("/users").doPOST({user:{email:t}},"signup_email")},s=function(t,e,i,a){return null==a&&(a={}),a.order_by=i,a.limit=t,a.offset=e,n.all("users").getList(a)},this}])}.call(this),function(){this.App.controller("CreateStep1Controller",["$scope","$document","$state","toastr","MnoeOrganizations","MnoeMarketplace","MnoErrorsHandler",function(t,e,n,i,a,s,r){"ngInject";var o;o=this,o.organization={},o.appSearch="",o.toggleApp=function(t){return t.checked=!t.checked},o.submitOrganisation=function(){var t;return o.form.$invalid&&!r.onlyServerError(o.form)?(t=angular.element(document.getElementById("org-form")),void e.scrollToElementAnimated(t)):(o.isLoading=!0,r.resetErrors(o.form),o.organization.app_nids=_.pluck(_.filter(o.marketplace.apps,{checked:!0}),"nid"),a.create(o.organization).then(function(t){return i.success("Organisation "+o.organization.name+" has been successfully created."),t=t.data.plain(),_.isEmpty(t.organization.active_apps)?n.go("dashboard.home.organization",{orgId:t.organization.id}):n.go("dashboard.customers.create-step-2",{orgId:t.organization.id})},function(t){return e.scrollTopAnimated(0),i.error("An error occurred while creating organisation "+o.organization.name+"."),r.processServerError(t,o.form)})["finally"](function(){return o.isLoading=!1}))},s.getApps().then(function(t){return o.marketplace=angular.copy(t.data)})}])}.call(this),function(){this.App.controller("CreateStep2Controller",["$stateParams","MnoeOrganizations","MnoAppsInstances",function(t,e,n){"ngInject";var i;i=this,i.mnoAppInstances=n,i.orgId=t.orgId,i.isLoading=!0,e.get(t.orgId).then(function(t){return i.organization=t.data})["finally"](function(){return i.isLoading=!1})}])}.call(this),function(){this.App.controller("InviteUserController",["$filter","$stateParams","$uibModalInstance","toastr","MnoeUsers","MnoErrorsHandler","USER_ROLES",function(t,e,n,i,a,s,r){"ngInject";var o;o=this,o.USER_ROLES=r,o.onSubmit=function(){return o.isLoading=!0,a.sendSignupEmail(o.user.email).then(function(t){return i.success("An email to "+o.user.email+" has been successfully sent."),n.close(o.user.email)},function(t){return i.error("An error occurred while sending an email to "+o.user.email+"."),s.processServerError(t)})["finally"](function(){return o.isLoading=!1})},o.onCancel=function(){return n.dismiss("cancel")}}])}.call(this),function(){this.App.controller("CreateUserController",["$filter","$stateParams","$uibModalInstance","toastr","MnoeUsers","MnoErrorsHandler","USER_ROLES","organization",function(t,e,n,i,a,s,r,o){"ngInject";var l;l=this,l.USER_ROLES=r,l.onSubmit=function(){return l.isLoading=!0,a.addUser(o,l.user).then(function(t){return i.success(l.user.name+" "+l.user.surname+" has been successfully added."),n.close(t.data.user)},function(t){return i.error("An error occurred while adding "+l.user.name+" "+l.user.surname+"."),s.processServerError(t)})["finally"](function(){return l.isLoading=!1})},l.onCancel=function(){return n.dismiss("cancel")}}])}.call(this),function(){this.App.controller("CreateStaffController",["$filter","$stateParams","$log","$uibModalInstance","toastr","MnoeUsers","MnoErrorsHandler","ADMIN_ROLES",function(t,e,n,i,a,s,r,o){"ngInject";var l,c;c=this,c.admin_roles=o,c.onSubmit=function(){return c.isLoading=!0,s.addStaff(c.user).then(function(t){return l(c.user)},function(t){return a.error("An error occurred while adding "+c.user.name+" "+c.user.surname+"."),n.error("An error occurred:",t)})["finally"](function(){return c.isLoading=!1})},c.onCancel=function(){return i.dismiss("cancel")},l=function(t){return s.sendSignupEmail(t.email).then(function(e){return a.success(t.name+" "+t.surname+" has been successfully added."),i.close(e.data)},function(e){return a.error("An error occurred while sending an email to "+t.email+"."),n.error("An error occurred:",e),s.removeStaff(c.user.id).then(function(t){},function(t){return a.error("An error occurred while deleting the user."),n.error("An error occurred:",t)})})}}])}.call(this),angular.module("frontendAdmin").run(["$templateCache",function(t){t.put("app/views/dashboard.layout.html",'<div id="page-wrapper" ng-class="{\'open\': main.toggle}" ng-cloak=""><div id="sidebar-wrapper"><ul class="sidebar"><li class="sidebar-main"><a ng-click="main.toggleSidebar()">Dashboard <span class="menu-icon glyphicon glyphicon-transfer"></span></a></li><li class="sidebar-title"><span>NAVIGATION</span></li><li class="sidebar-list"><a href="#/home">Dashboard <span class="menu-icon fa fa-tachometer"></span></a></li><li class="sidebar-list"><a href="#/finance">Finance <span class="menu-icon fa fa-money"></span></a></li><li class="sidebar-list"><a href="#/customers">Customers <span class="menu-icon fa fa-users"></span></a></li><li class="sidebar-list" ng-show="main.staffPageAuthorized.indexOf(main.user.admin_role)!=-1"><a href="#/staff">Staff <span class="menu-icon fa fa-wrench"></span></a></li></ul></div><div id="content-wrapper"><div class="page-content"><div class="row header"><div class="col-xs-12"><div class="user pull-right"><div class="item" uib-dropdown=""><a href="#" uib-dropdown-toggle=""><img src="assets/images/avatar.jpg"></a><ul class="dropdown-menu dropdown-menu-right"><li class="link"><a href="/dashboard/">Exit</a></li></ul></div></div><div class="meta"><div class="page">Admin Platform</div><div class="breadcrumb-links"><div ncy-breadcrumb=""></div></div></div></div></div><div ui-view=""></div></div></div></div>'),t.put("app/components/mno-confirm/mno-confirm.html",'<div class="modal-header"><button type="button" class="close" aria-label="Close" ng-click="modalOptions.close()"><span aria-hidden="true">&times;</span></button><h4 class="modal-title">{{modalOptions.headerText}}</h4></div><div class="modal-body"><p>{{modalOptions.bodyText}}</p></div><div class="modal-footer"><button type="button" class="btn btn-default" ng-click="modalOptions.close()">{{modalOptions.closeButtonText}}</button> <button type="button" class="btn btn-primary" ng-click="modalOptions.ok();">{{modalOptions.actionButtonText}}</button></div>'),
t.put("app/components/mno-pagination/mno-pagination.html",'<div class="nb-items-col"><label># of items</label><select class="items-per-page-select form-control" ng-model="nbItems" ng-change="onPageChange()" ng-options="i for i in nbItemsValues" ng-disabled="isLoading"></select></div><uib-pagination ng-model="page" ng-show="totalItems > nbItems" total-items="totalItems" items-per-page="nbItems" ng-change="onPageChange()" max-size="pagination.maxPages" rotate="false" ng-disabled="isLoading"></uib-pagination>'),t.put("app/components/mnoe-organizations-list/mnoe-organizations-list.html",'<rd-widget><rd-widget-header icon="fa-sitemap" title="{{organizations.widgetTitle}}">&nbsp;<a href="" ng-click="switchState()" ng-show="organizations.list && organizations.switchLinkTitle" ng-class="{\'disabled\': organizations.loading}">{{organizations.switchLinkTitle}}</a> <input type="text" ng-model="organizations.search" ng-change="searchChange()" ng-model-options="{ debounce: 1000 }" placeholder="Search all" class="form-control input-sm search-bar"></rd-widget-header><rd-widget-body loading="organizations.loading" classes="large no-padding"><table class="table table-layout-fixed"><thead><tr><th>Name</th><th style="width: 100px;">Creation</th></tr></thead><tbody><tr ng-repeat="organization in organizations.list"><td><a ui-sref="dashboard.home.organization({orgId: organization.id})">{{::organization.name}}</a></td><td>{{::organization.created_at | date: \'dd/MM/yyyy\'}}</td></tr></tbody></table></rd-widget-body><rd-widget-footer ng-show="organizations.list && state == \'all\' && !searchMode"><mno-pagination page="organizations.page" nb-items="organizations.nbItems" total-items="organizations.totalItems" on-change-cb="organizations.pageChangedCb(nbItems, page)" is-loading="organizations.loading"></mno-pagination></rd-widget-footer></rd-widget>'),t.put("app/components/mnoe-organizations-local-list/mnoe-organizations-local-list.html",'<rd-widget><rd-widget-header icon="fa-sitemap" title="{{organizations.widgetTitle}}">&nbsp;<a href="" ng-click="switchState()" ng-show="list && organizations.switchLinkTitle">{{organizations.switchLinkTitle}}</a> <input type="text" ng-model="organizations.search" ng-change="searchChange()" placeholder="Search all" class="form-control input-sm search-bar"></rd-widget-header><rd-widget-body loading="!list" classes="large no-padding"><table class="table table-layout-fixed"><thead><tr><th>Name</th><th style="width: 100px;">Creation</th></tr></thead><tbody><tr ng-repeat="organization in organizations.displayList"><td><a ui-sref="dashboard.home.organization({orgId: organization.id})">{{::organization.name}}</a></td><td>{{organization.created_at | date: \'dd/MM/yyyy\'}}</td></tr></tbody></table></rd-widget-body></rd-widget>'),t.put("app/components/mnoe-staffs-list/mnoe-staffs-list.html",'<rd-widget><rd-widget-header icon="fa-wrench" title="{{$ctrl.staff.widgetTitle}}">&nbsp;All staff</rd-widget-header><rd-widget-body classes="large no-padding"><div><table class="table" st-pipe="$ctrl.callServer" st-table="$ctrl.displayed"><table st-pipe="$ctrl.callServer" st-table="$ctrl.listOfStaff" class="table table-striped"><thead><tr><th st-sort="name" class="col-lg-2">Name</th><th st-sort="surname" class="col-lg-3">Surname</th><th st-sort="created_at" class="col-lg-3">Creation</th><th st-sort="admin_role" class="col-lg-3">Role</th><th></th><th></th></tr><tr><th><input st-search="name" placeholder="Search for name" class="form-control input-sm search-bar" type="text"></th><th><input st-search="surname" placeholder="Search for surname" class="form-control input-sm search-bar" type="text"></th><th></th><th><select st-search="admin_role" class="form-control input-sm"><option value="">All</option><option ng-repeat="role in $ctrl.staff.roles" value="{{role}}">{{role}}</option></select></th><th></th><th></th></tr></thead><tbody ng-show="$ctrl.staff.loading"><tr><td colspan="6" class="text-center">Loading ...</td></tr></tbody><tbody ng-show="!$ctrl.staff.loading"><tr ng-repeat="staffElem in $ctrl.listOfStaff"><td>{{staffElem.name}}</td><td>{{staffElem.surname}}</td><td>{{staffElem.created_at | date: \'dd/MM/yyyy\'}}</td><td><span ng-show="!$ctrl.staff.editmode[staffElem.id]">{{staffElem.admin_role}}</span><select ng-model="staffElem.admin_role" ng-show="$ctrl.staff.editmode[staffElem.id]" class="user-role-select form-control input-sm"><option ng-repeat="role in $ctrl.staff.roles" value="{{role}}">{{role}}</option></select></td><td><a href="" ng-hide="$ctrl.staff.editmode[staffElem.id]" ng-click="$ctrl.staff.editmode[staffElem.id] = true"><i class="fa fa-pencil"></i></a></td><td><a href="" ng-hide="$ctrl.staff.editmode[staffElem.id]" ng-click="$ctrl.staff.remove(staffElem)"><i class="fa fa-times"></i></a> <a href="" ng-show="$ctrl.staff.editmode[staffElem.id]" ng-click="$ctrl.staff.update(staffElem)"><i class="fa fa-check"></i></a></td></tr></tbody></table></table></div></rd-widget-body><rd-widget-footer ng-show="$ctrl.listOfStaff && $ctrl.state == \'all\' && !searchMode"><mno-pagination page="$ctrl.staff.page" nb-items="$ctrl.staff.nbItems" total-items="$ctrl.staff.totalItems" on-change-cb="$ctrl.staff.pageChangedCb(nbItems, page)" is-loading="$ctrl.staff.loading"></mno-pagination></rd-widget-footer></rd-widget>'),t.put("app/components/mnoe-users-list/mno-users-list.html",'<rd-widget><rd-widget-header icon="fa-users" title="{{users.widgetTitle}}">&nbsp;<a href="" ng-click="switchState()" ng-show="users.list && users.switchLinkTitle" ng-class="{\'disabled\': users.loading}">{{users.switchLinkTitle}}</a> <input type="text" ng-model="users.search" ng-change="searchChange()" ng-model-options="{ debounce: 1000 }" placeholder="Search all" class="form-control input-sm search-bar"></rd-widget-header><rd-widget-body loading="users.loading" classes="large no-padding"><table class="table table-layout-fixed"><thead><tr><th>Username</th><th style="width: 100px;">Creation</th></tr></thead><tbody><tr ng-repeat="user in users.list"><td><a ui-sref="dashboard.home.user({userId: user.id})"><div ng-show="user.name && user.surname">{{::user.name}} {{::user.surname}}</div><div ng-show="!user.name && !user.surname">nc</div><small>{{::user.email}}</small></a></td><td>{{::user.created_at | date: \'dd/MM/yyyy\'}}</td></tr></tbody></table></rd-widget-body><rd-widget-footer ng-show="users.list && state == \'all\' && !searchMode"><mno-pagination page="users.page" nb-items="users.nbItems" total-items="users.totalItems" on-change-cb="users.pageChangedCb(nbItems, page)" is-loading="users.loading"></mno-pagination></rd-widget-footer></rd-widget>'),t.put("app/components/mnoe-users-local-list/mnoe-users-local-list.html",'<rd-widget><rd-widget-header icon="fa-users" title="{{users.widgetTitle}}">&nbsp;<a href="" ng-click="switchState()" ng-show="list && users.switchLinkTitle">{{users.switchLinkTitle}}</a> <input type="text" ng-model="users.search" ng-change="searchChange()" placeholder="Search all" class="form-control input-sm search-bar"></rd-widget-header><rd-widget-body loading="!list" classes="medium no-padding"><table class="table table-layout-fixed"><thead><tr><th>Username</th><th style="width: 100px;">Creation</th><th style="width: 140px;">Status</th><th style="width: 100px;"></th></tr></thead><tbody><tr ng-repeat="user in users.displayList"><td><a ui-sref="dashboard.home.user({userId: user.id})"><div ng-show="user.name && user.surname">{{::user.name}} {{::user.surname}}</div><div ng-show="!user.name && !user.surname">nc</div><small>{{::user.email}}</small></a></td><td>{{user.created_at | date: \'dd/MM/yyyy\'}}</td><td><button ng-show="user.status === \'pending\'" ng-click="sendInvitation(user)" class="btn btn-xs btn-default" ng-disabled="user.isSendingInvite"><span ng-show="user.isSendingInvite"><i class="fa fa-spinner fa-pulse fa-fw"></i></span> INVITE</button> <button ng-show="user.status === \'invited\'" ng-click="sendInvitation(user)" class="btn btn-xs btn-default" ng-disabled="user.isSendingInvite"><span ng-show="user.isSendingInvite"><i class="fa fa-spinner fa-pulse fa-fw"></i></span> RESEND INVITE</button> <span ng-show="user.status === \'active\'">Active</span></td><td><a href="" ng-click="impersonateUser(user)">Log In as...</a></td></tr></tbody></table></rd-widget-body></rd-widget>'),t.put("app/components/rdash-angular/kpi-body-currency.html","<span>{{currency}} {{amount}}</span>"),t.put("app/components/rdash-angular/kpi-body-number.html","<span>{{number}}</span>"),t.put("app/components/rdash-angular/kpi.html",'<div class="visual"><i class="fa" ng-class="icon"></i></div><div class="details"><div class="loader" ng-show="loading"><i class="fa fa-2x fa-spin fa-refresh"></i></div><div class="body" ng-transclude=""></div><div class="desc">{{description}}</div></div><a class="more" ng-href="{{link}}" ng-if="link">{{ linkText || \'View more\'}} <i class="fa fa-arrow-circle-o-right"></i></a>'),t.put("app/views/customers/customers.html",'<div id="customers"><div class="row"><div class="col-lg-3 col-md-6 col-xs-12"><rd-kpi class="kpi-color-1" description="Users" icon="fa-users" loading="!vm.users.totalCount"><rd-kpi-body-number number="{{vm.users.totalCount}}"></rd-kpi-body-number></rd-kpi></div><div class="col-lg-3 col-md-6 col-xs-12"><rd-kpi class="kpi-color-2" description="Organizations" icon="fa-sitemap" loading="!vm.organizations.totalCount"><rd-kpi-body-number number="{{vm.organizations.totalCount}}"></rd-kpi-body-number></rd-kpi></div></div><div class="row"><div class="col-xs-12"><div class="btn-group pull-right top-buffer-1" uib-dropdown="" keyboard-nav=""><button id="simple-btn-keyboard-nav" type="button" class="btn btn-primary" uib-dropdown-toggle="">New customer <span class="caret"></span></button><ul class="dropdown-menu" uib-dropdown-menu="" role="menu" aria-labelledby="simple-btn-keyboard-nav"><li role="menuitem"><a href="" ng-click="vm.inviteUserModal()">Invite a customer</a></li><li role="menuitem"><a ui-sref="dashboard.customers.create-step-1">Create a customer</a></li></ul></div></div><div class="col-xs-12"><mnoe-organizations-list view="all"></mnoe-organizations-list></div><div class="col-xs-12"><mnoe-users-list view="all"></mnoe-users-list></div></div></div>'),t.put("app/views/finance/finance.html",'<div class="row"><div class="col-lg-3 col-md-6 col-xs-12"><rd-kpi class="kpi-color-1" description="Current billing" icon="fa-file-text-o" loading="!vm.invoices.currentBillingAmount"><rd-kpi-body-currency amount="{{vm.invoices.currentBillingAmount.amount}}" currency="{{vm.invoices.currentBillingAmount.currency}}"><rd-kpi-body-currency></rd-kpi-body-currency></rd-kpi-body-currency></rd-kpi></div><div class="col-lg-3 col-md-6 col-xs-12"><rd-kpi class="kpi-color-2" description="Last customer invoicing" icon="fa-file-text-o" loading="!vm.invoices.lastInvoicingAmount"><rd-kpi-body-currency amount="{{vm.invoices.lastInvoicingAmount.amount}}" currency="{{vm.invoices.lastInvoicingAmount.currency}}"><rd-kpi-body-currency></rd-kpi-body-currency></rd-kpi-body-currency></rd-kpi></div><div class="col-lg-3 col-md-6 col-xs-12"><rd-kpi class="kpi-color-3" description="Last revenue" icon="fa-file-text-o" loading="!vm.invoices.lastPortfolioAmount"><rd-kpi-body-currency amount="{{vm.invoices.lastPortfolioAmount.amount}}" currency="{{vm.invoices.lastPortfolioAmount.currency}}"><rd-kpi-body-currency></rd-kpi-body-currency></rd-kpi-body-currency></rd-kpi></div><div class="col-lg-3 col-md-6 col-xs-12"><rd-kpi class="kpi-color-4" description="Last commission" icon="fa-file-text-o" loading="!vm.invoices.lastCommissionAmount"><rd-kpi-body-currency amount="{{vm.invoices.lastCommissionAmount.amount}}" currency="{{vm.invoices.lastCommissionAmount.currency}}"><rd-kpi-body-currency></rd-kpi-body-currency></rd-kpi-body-currency></rd-kpi></div></div><div class="row"><div class="col-lg-6"><rd-widget><rd-widget-header icon="fa-exclamation-circle" title="Customer accounts in arrears"></rd-widget-header><rd-widget-body classes="large no-padding"><div class="table-responsive"><table class="table"><thead><tr><th>Organisation</th><th>Amount</th><th>Reason</th></tr></thead><tbody><tr ng-repeat="arrear in vm.organizations.inArrears"><td>{{arrear.name}}</td><td ng-if="arrear.amount">{{arrear.amount.options.iso_code}} {{arrear.amount.value}}</td><td ng-if="!arrear.amount">-</td><td>{{arrear.category}}</td></tr></tbody></table></div></rd-widget-body></rd-widget></div><div class="col-lg-6"><rd-widget><rd-widget-header icon="fa-file-text-o" title="Your partner reports"></rd-widget-header><rd-widget-body loading="!vm.invoices.tenantInvoices" classes="large no-padding"><div class="table-responsive"><table class="table"><thead><tr><th>Start</th><th>End</th><th>Revenue</th><th>Commission</th><th class="text-center">Paid</th></tr></thead><tbody><tr ng-repeat="invoice in vm.invoices.tenantInvoices"><td>{{invoice.started_at | date: \'dd/MM/yyyy\'}}</td><td>{{invoice.ended_at | date: \'dd/MM/yyyy\'}}</td><td>{{invoice.total_portfolio_amount.options.iso_code}} {{invoice.total_portfolio_amount.value}}</td><td>{{invoice.total_commission_amount.options.iso_code}} {{invoice.total_commission_amount.value}}</td><td class="text-center"><span ng-if="invoice.paid_at" class="text-success">Yes</span> <span ng-if="!invoice.paid_at" class="text-danger">No</span></td></tr></tbody></table></div></rd-widget-body></rd-widget></div></div>'),t.put("app/views/home/home.html",'<div class="row"><div class="col-lg-3 col-md-6 col-xs-12"><rd-kpi class="kpi-color-1" description="Users" icon="fa-users" link="#/customers" link-text="{{vm.users.kpi.new_month_count}} new this current month" loading="!vm.users.kpi"><rd-kpi-body-number number="{{vm.users.kpi.total_count}}"><rd-kpi-body-number></rd-kpi-body-number></rd-kpi-body-number></rd-kpi></div><div class="col-lg-3 col-md-6 col-xs-12"><rd-kpi class="kpi-color-2" description="Organizations" icon="fa-sitemap" link="#/customers" link-text="{{vm.organizations.kpi.with_cc_count}} with a credit card" loading="!vm.organizations.kpi"><rd-kpi-body-number number="{{vm.organizations.kpi.total_count}}"><rd-kpi-body-number></rd-kpi-body-number></rd-kpi-body-number></rd-kpi></div><div class="col-lg-3 col-md-6 col-xs-12"><rd-kpi class="kpi-color-3" description="Last customer invoicing" icon="fa-file-text-o" link="#/finance" loading="!vm.invoices.lastInvoicingAmount"><rd-kpi-body-currency amount="{{vm.invoices.lastInvoicingAmount.amount}}" currency="{{vm.invoices.lastInvoicingAmount.currency}}"><rd-kpi-body-currency></rd-kpi-body-currency></rd-kpi-body-currency></rd-kpi></div><div class="col-lg-3 col-md-6 col-xs-12"><rd-kpi class="kpi-color-4" description="Still to be paid" icon="fa-money" link="#/finance" loading="!vm.invoices.outstandingAmount"><rd-kpi-body-currency amount="{{vm.invoices.outstandingAmount.amount}}" currency="{{vm.invoices.outstandingAmount.currency}}"><rd-kpi-body-currency></rd-kpi-body-currency></rd-kpi-body-currency></rd-kpi></div></div><div class="row"><div class="col-md-6"><mnoe-users-list view="last"></mnoe-users-list></div><div class="col-md-6"><mnoe-organizations-list view="last"></mnoe-organizations-list></div></div>'),t.put("app/views/organization/organization.html",'<div id="organization"><div class="row"><div class="col-xs-12"><h1>Organisation info</h1><rd-widget loading="!vm.organization.invoices"><rd-widget-header icon="fa-sitemap" title="{{vm.organization.name}}"></rd-widget-header><rd-widget-body><div class="bs-row row"><div class="col-xs-6"><div class="label-cell">UID</div></div><div class="col-xs-6">{{vm.organization.uid}}</div></div><div class="bs-row row"><div class="col-xs-6"><div class="label-cell">Credit Card</div></div><div class="col-xs-6"><span ng-if="vm.organization.credit_card.presence" class="text-success">Yes</span> <span ng-if="!vm.organization.credit_card.presence" class="text-danger">No</span></div></div><div class="bs-row row"><div class="col-sm-6"><div class="label-cell">Active apps</div></div><div class="col-sm-6"><span ng-if="vm.organization.active_apps.length === 0">(none)</span><div ng-if="vm.organization.active_apps.length > 0" class="bs-row row"><div class="app-wrapper col-xs-6 col-sm-4 col-md-3" ng-repeat="app in vm.organization.active_apps"><div class="small-app-card ellipsis"><i ng-show="vm.mnoAppInstances.isConnected(app)" class="fa fa-check-circle app-state state-success" uib-tooltip="{{::app.app_name}} is connected!" tooltip-append-to-body="true"></i> <i ng-show="!vm.mnoAppInstances.isConnected(app)" class="fa fa-exclamation-circle app-state state-warning" uib-tooltip="{{::app.app_name}} is not connected." tooltip-append-to-body="true"></i> <img ng-src="{{::app.app_logo}}" width="60"> <span>{{::app.app_name}}</span></div></div></div></div></div></rd-widget-body></rd-widget></div></div><div class="row"><div class="col-xs-12 top-buffer-1"><button role="button" ng-click="vm.users.createUserModal()" ng-disabled="!vm.organization" class="btn btn-primary">Add a user</button></div></div><div class="row"><div class="col-md-6"><mnoe-users-local-list list="vm.organization.members" organization="vm.organization" view="all"></mnoe-users-local-list></div><div class="col-md-6"><rd-widget><rd-widget-header icon="fa-file-text-o" title="Invoices"></rd-widget-header><rd-widget-body loading="!vm.organization.invoices" classes="medium no-padding"><div class="table-responsive"><table class="table"><thead><tr><th>Start</th><th>End</th><th>Amount</th><th class="text-center">Paid</th></tr></thead><tbody><tr ng-repeat="invoice in vm.organization.invoices"><td>{{invoice.started_at | date: \'dd/MM/yyyy\'}}</td><td>{{invoice.ended_at | date: \'dd/MM/yyyy\'}}</td><td>{{invoice.amount.options.iso_code}} {{invoice.amount.value}}</td><td class="text-center"><span ng-if="invoice.paid" class="text-success">Yes</span> <span ng-if="!invoice.paid" class="text-danger">No</span></td></tr></tbody></table></div></rd-widget-body></rd-widget></div></div></div>'),t.put("app/views/staff/staff.html",'<div class="row"><div class="col-xs-8 col-lg-offset-1 top-buffer-1"><button role="button" ng-click="vm.staff.createModal()" class="btn btn-primary">Add a staff</button></div></div><div class="row"><div class="col-lg-10 col-lg-offset-1 col-md-12"><mnoe-staffs-list view="all"></mnoe-staffs-list></div></div>'),t.put("app/views/user/user.html",'<div class="row"><div class="col-xs-12"><h1><i class="fa fa-users"></i> User info</h1><div class="panel panel-default top-buffer-2"><div class="panel-heading" ng-show="vm.user"><h3 ng-show="user.name && user.surname" class="panel-title">{{::vm.user.name}} {{::vm.user.surname}}</h3><h3 ng-show="!user.name && !user.surname" class="panel-title">{{::vm.user.email}}</h3></div><div class="panel-body"><rd-loading ng-show="!vm.user"></rd-loading><div ng-show="vm.user"><div class="bs-row row"><div class="col-md-3"><div class="label-cell">Email</div></div><div class="col-md-3">{{::vm.user.email}}</div></div><div class="bs-row row"><div class="col-md-3"><div class="label-cell">UID</div></div><div class="col-md-3">{{::vm.user.uid}}</div></div><div class="bs-row row"><div class="col-md-3"><div class="label-cell">Phone</div></div><div class="col-md-3">{{vm.user.phone || \'(none)\'}}</div></div><div class="bs-row row"><div class="col-sm-3"><div class="label-cell">Admin role</div></div><div class="col-sm-3">{{vm.user.admin_role || \'(none)\'}}</div></div><div class="bs-row row"><div class="col-sm-3"><div class="label-cell">Creation date</div></div><div class="col-sm-3">{{vm.user.created_at | amCalendar }}</div></div><div class="bs-row row"><div class="col-sm-3"><div class="label-cell">Confirmed</div></div><div class="col-sm-3">{{(vm.user.confirmed_at | amCalendar) || \'(Not confirmed yet)\'}}</div></div><div class="bs-row row"><div class="col-sm-3"><div class="label-cell">Last sign in</div></div><div class="col-sm-3">{{(vm.user.last_sign_in_at | amCalendar) || \'(Never signed in yet)\'}}</div></div></div></div></div><div class="bs-row"><div class="col-sm-4 col-sm-offset-4"><button class="btn btn-primary center-block" ng-click="vm.impersonateUser()">Log In as User</button></div><div class="col-sm-12 top-buffer-2"><mnoe-organizations-local-list list="vm.user.organizations" view="all"></mnoe-organizations-local-list></div></div></div></div>'),t.put("app/views/customers/create-step-1/create-step-1.html",'<div id="create-step-1"><div class="row"><div class="col-xs-12"><h1>Create a new customer</h1><form name="vm.form" novalidate=""><rd-widget id="org-form" class="top-buffer-2"><rd-widget-header icon="fa-sitemap" title="Organisation details"></rd-widget-header><rd-widget-body><div class="flex-container flex-center"><div class="form-group flex-50"><label class="control-label" for="organization-name">Organisation name</label> <input id="organization-name" name="name" type="text" ng-model="vm.organization.name" class="form-control" required=""><div ng-messages="vm.form.name.$error" role="alert" ng-if="vm.form.name.$dirty || vm.form.$submitted"><p ng-message="required" class="text-danger">Name is required.</p><p ng-message="server" class="help-block">Name {{ main.errorHandler.errorMessage(\'name\') }}</p></div></div></div></rd-widget-body></rd-widget><rd-widget class="top-buffer-2"><rd-widget-header icon="fa-rocket" title="Select your apps"><input type="text" ng-model="vm.appSearch" placeholder="Search" class="form-control input-sm search-bar"></rd-widget-header><rd-widget-body loading="!vm.marketplace"><div class="apps-container"><div class="app-icon" ng-repeat="app in vm.marketplace.apps | filter:{name: vm.appSearch}"><div class="app-icon-wrapper" ng-click="vm.toggleApp(app)"><div class="checked" ng-show="app.checked"><i class="fa fa-check fa-5x"></i></div><img class="app-logo img-thumbnail" ng-src="{{::main.trustSrc(app.logo)}}" alt="{{::app.name}} logo" title="{{::app.tiny_description}}"></div><div class="app-title">{{::app.name}}</div></div></div></rd-widget-body></rd-widget><button type="submit" class="btn btn-danger pull-right top-buffer-2" ng-click="vm.submitOrganisation()" ng-disabled="vm.isLoading"><span ng-show="vm.isLoading"><i class="fa fa-spinner fa-pulse fa-fw"></i></span> Create</button></form></div></div></div>'),t.put("app/views/customers/create-step-2/create-step-2.html",'<div id="create-step-1"><div class="row"><div class="col-xs-12"><h1>Connect your customer\'s cloud apps</h1><rd-widget class="top-buffer-2" loading="vm.isLoading"><rd-widget-header icon="fa-plug fa-cloud" title="{{::vm.organization.name}}\'s cloud apps"></rd-widget-header><rd-widget-body classes="no-padding"><table class="table table-layout-fixed"><thead><tr><th>App</th><th style="width: 33%;">State</th><th style="width: 75px;">Action</th></tr></thead><tbody><tr ng-repeat="app in vm.organization.active_apps | filter : {stack: \'connector\'}"><td class="nowrap"><img class="small-app-logo" ng-src="{{::main.trustSrc(app.app_logo)}}" alt="{{::app.name}} logo"> <span class="app-name">{{::app.name}}</span></td><td><div ng-show="!vm.mnoAppInstances.isOauthConnected(app)"><i class="fa fa-exclamation-triangle text-danger"></i> <span>Not connected</span></div><div ng-show="vm.mnoAppInstances.isOauthConnected(app)"><i class="fa fa-check-square-o text-success"></i> <span>Connected!</span></div></td><td><a ng-show="!vm.mnoAppInstances.isOauthConnected(app)" ng-href="{{vm.mnoAppInstances.oAuthConnectPath(app)}}">Connect</a></td></tr></tbody></table></rd-widget-body></rd-widget><button type="button" class="btn btn-primary pull-right top-buffer-2" ui-sref="dashboard.home.organization({ orgId: vm.orgId })">Next <i class="fa fa-chevron-right"></i></button></div></div></div>'),t.put("app/views/customers/invite-user-modal/invite-user.html",'<div id="create-user"><div class="modal-header"><h3 class="modal-title">Invite a user</h3></div><form name="vm.form.user" novalidate=""><div class="modal-body"><div class="row"><div class="col-sm-6 col-sm-offset-3"><input type="email" class="form-control input-sm" id="user-email" ng-model="vm.user.email" placeholder="Email" aria-label="Email" required=""></div></div></div></form><div class="modal-footer"><div class="row actions"><div class="col-xs-12"><button type="button" ng-click="vm.onSubmit()" ng-disabled="vm.isLoading || vm.form.user.$invalid" class="btn btn-primary"><span ng-show="vm.isLoading"><i class="fa fa-spinner fa-pulse fa-fw"></i></span> Send</button> <a href="" ng-click="vm.onCancel()"><i class="fa fa-times"></i> cancel</a></div></div></div></div>'),t.put("app/views/organization/create-user-modal/create-user.html",'<div id="create-user"><div class="modal-header"><h3 class="modal-title">Add a new user</h3></div><form name="vm.form.user" novalidate=""><div class="modal-body"><div class="row"><div class="col-sm-6"><input type="text" class="form-control input-sm" id="user-first-name" ng-model="vm.user.name" placeholder="First Name" aria-label="First Name" required=""></div><div class="col-sm-6"><input type="text" class="form-control input-sm" id="user-last-name" ng-model="vm.user.surname" placeholder="Last Name" aria-label="Last Name" required=""></div></div><div class="row top-buffer-1"><div class="col-sm-6"><input type="phone" class="form-control input-sm" id="user-phone" ng-model="vm.user.phone" placeholder="Phone" aria-label="Phone" required=""></div><div class="col-sm-6"><input type="email" class="form-control input-sm" id="user-email" ng-model="vm.user.email" placeholder="Email" aria-label="Email" required=""></div></div><div class="row"><div class="col-sm-6 col-sm-offset-3"><select ng-model="vm.user.role" class="form-control input-sm top-buffer-1" ng-options="role for role in vm.USER_ROLES" required=""><option value="" disabled="" selected="" style="display: none;">Role</option></select></div></div></div></form><div class="modal-footer"><div class="row actions"><div class="col-xs-12"><button type="button" ng-click="vm.onSubmit()" ng-disabled="vm.isLoading || vm.form.user.$invalid" class="btn btn-primary"><span ng-show="vm.isLoading"><i class="fa fa-spinner fa-pulse fa-fw"></i></span> Save</button> <a href="" ng-click="vm.onCancel()"><i class="fa fa-times"></i> cancel</a></div></div></div></div>'),t.put("app/views/staff/create-staff-modal/create-staff.html",'<div id="staff-user-modal"><div class="modal-header"><h3 class="modal-title">Add a new staff</h3></div><form name="vm.form.user" novalidate=""><div class="modal-body"><div class="row"><div class="col-sm-6"><input type="text" class="form-control input-sm" id="user-first-name" ng-model="vm.user.name" placeholder="First Name" aria-label="First Name" required=""></div><div class="col-sm-6"><input type="text" class="form-control input-sm" id="user-last-name" ng-model="vm.user.surname" placeholder="Last Name" aria-label="Last Name" required=""></div></div><div class="row top-buffer-1"><div class="col-sm-6"><input type="email" class="form-control input-sm" id="user-email" ng-model="vm.user.email" placeholder="Email" aria-label="Email" required=""></div><div class="col-sm-6"><select ng-model="vm.user.admin_role" class="form-control input-sm" ng-options="role for role in vm.admin_roles" required=""><option value="" disabled="" selected="">- Role -</option></select></div></div></div></form><div class="modal-footer"><div class="row actions"><div class="col-xs-12"><button type="button" ng-click="vm.onSubmit()" ng-disabled="vm.isLoading || vm.form.user.$invalid" class="btn btn-primary"><span ng-show="vm.isLoading"><i class="fa fa-spinner fa-pulse fa-fw"></i></span> Save</button> <a href="" ng-click="vm.onCancel()"><i class="fa fa-times"></i> cancel</a></div></div></div></div>')}]);
//# sourceMappingURL=../maps/scripts/app-5ca8772d0e.js.map
